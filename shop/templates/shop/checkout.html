{% extends 'shop/base.html' %}

{% block title %}
Checkout - My Awesome Cart
{% endblock%}

{% block body%}

<div class="container">
    <div class="col my-2">
        <h2>step 1 - My Awesome Cart Express Checkout - Review Your Items</h2>
        <div class="my-4">
            <ol class="list-group list-group-numbered" id="items">
            </ol>
        </div>
    </div>

    <div class="col my-4">
        <h2>step 2 - Enter address and other detail</h2>
        <form class="row g-3" method="post" action="/shop/checkout/"> {% csrf_token %}
            <input type="hidden" name="items_json" id="itemsJson">
            <div class="col-md-6">
                <label for="inputname" class="form-label">Name</label>
                <input type="name" class="form-control" id="inputname" name="name">
            </div>
            <div class="col-md-6">
                <label for="inputEmail4" class="form-label">Email</label>
                <input type="email" class="form-control" id="inputEmail4" name="email">
            </div>
            <div class="col-12">
                <label for="inputnumber" class="form-label">Phone Number</label>
                <input type="tel" class="form-control" id="inputnumber" placeholder="1234567890" name="phone_number">
            </div>
            <div class="col-12">
                <label for="inputAddress" class="form-label">Address</label>
                <input type="text" class="form-control" id="inputAddress" placeholder="1234 Main St" name="address1">
            </div>
            <div class="col-12">
                <label for="inputAddress2" class="form-label">Address line 2</label>
                <input type="text" class="form-control" id="inputAddress2" placeholder="Apartment, studio, or floor" name="address2">
            </div>
            <div class="col-md-6">
                <label for="inputCity" class="form-label">City</label>
                <input type="text" class="form-control" id="inputCity" name="city">
            </div>
            <div class="col-md-4">
                <label for="inputState" class="form-label">State</label>
                <input type="text" class="form-control" , id="inputstate" , placeholder="State" name="state">
            </div>
            <div class="col-md-2">
                <label for="inputZip" class="form-label">Zip</label>
                <input type="text" class="form-control" id="inputZip" name="zip_code">
            </div>
            <div class="col-12">
                <button type="submit" class="btn btn-primary">Place Order</button>
            </div>
        </form>
    </div>
</div>

{% endblock %}

{% block js %}

<script>

    let cart = {};

    if (localStorage.getItem('cart') != null) {
        cart = JSON.parse(localStorage.getItem('cart'));
    }

    console.log(cart);
    let sum = 0;

    for (item in cart) {
        let name = cart[item][1];
        let qty = cart[item][0];
        sum = sum + qty;
        mystr = ` <li class="list-group-item d-flex justify-content-between align-items-start">
                    <div class="ms-2 me-auto">
                        <div class="fw-bold">${name}</div>
                    </div>
                    <span class="badge text-bg-primary rounded-pill">${qty}</span>
                </li> `

        $('#items').append(mystr);
    }

    document.getElementById('cart').innerHTML = sum;
</script>

{% endblock %}